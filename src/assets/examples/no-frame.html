<html>
  <head>
    <script src="../js/globals.js"></script>
    <script src="../js/app.js"></script>
    <link rel="stylesheet" href="../css/app.css">
    <style>
      body {
        font-family: 'Arial', 'Helvetica', 'sans-serif'
      }
      textarea {
        width: 100%;
        height:300px;
      }
      #buttons {
        margin-top: 10px;
      }
    </style>
    <script type="text/javascript">
      var cfmClient;

      function newFile() {
        cfmClient && cfmClient.newFile();
      }

      function openFile() {
        // no callback for open - we will handle it in the clientInit event callback
        cfmClient && cfmClient.openFileDialog();
      }

      function saveFile() {
        cfmClient && cfmClient.saveContent(getTextValue());
      }

      function saveFileAs() {
        cfmClient && cfmClient.saveFileAsDialog(getTextValue());
      }

      function getTextValue() {
        return document.getElementById("text").value;
      }

      function setTextValue(text) {
        document.getElementById("text").value = text;
      }

      function setClient(client) {
        cfmClient = client;
      }
    </script>
  </head>
  <body>
    <h2>Demo App</h2>
    <p>
      This simple demo app uses the textarea below to edit text files.  You can either use the menu bar or the buttons below to open, save and create new files.
    </p>
    <div>
      <textarea cols="50" rows="10" id="text"></textarea>
    </div>
    <div id="buttons">
      <button onclick="newFile()">New</button>
      <button onclick="openFile()">Open</button>
      <button onclick="saveFile()">Save</button>
      <button onclick="saveFileAs()">Save As</button>
    </div>
    <script type="text/javascript">
      var clientOptions = {
        providers: [
          "localStorage",
          {"name": "readOnly", json: {
            "first-example": "This is the first readonly example",
            "second-example": "This is the second readonly example"
          }},
          "googleDrive",
          "documentStore"
        ]
      };
      CloudFileManager.init(clientOptions)
      CloudFileManager.clientConnect(function (event) {
        console.log(event);
        switch (event.type) {
          case 'connected':
            setClient(event.data.client);
            break;

          case 'getContent':
            event.callback(getTextValue());
            break;

          case 'newedFile':
            setTextValue('');
            break;

          case 'openedFile':
            setTextValue(event.data.content);
            break;
        }
      });

      document.getElementById("text").focus()
    </script>
  </body>
</html>
